var ut=Object.defineProperty;var ft=(e,n,t)=>n in e?ut(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var ae=(e,n,t)=>(ft(e,typeof n!="symbol"?n+"":n,t),t);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function t(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerPolicy&&(o.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?o.credentials="include":l.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(l){if(l.ep)return;l.ep=!0;const o=t(l);fetch(l.href,o)}})();function he(){}function nt(e){return e()}function ze(){return Object.create(null)}function oe(e){e.forEach(nt)}function it(e){return typeof e=="function"}function Ee(e,n){return e!=e?n==n:e!==n||e&&typeof e=="object"||typeof e=="function"}let Me;function Ge(e,n){return e===n?!0:(Me||(Me=document.createElement("a")),Me.href=n,e===Me.href)}function ct(e){return Object.keys(e).length===0}function f(e,n){e.appendChild(n)}function ne(e,n,t){e.insertBefore(n,t||null)}function ee(e){e.parentNode&&e.parentNode.removeChild(e)}function dt(e,n){for(let t=0;t<e.length;t+=1)e[t]&&e[t].d(n)}function w(e){return document.createElement(e)}function at(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function x(e){return document.createTextNode(e)}function O(){return x(" ")}function ht(){return x("")}function W(e,n,t,i){return e.addEventListener(n,t,i),()=>e.removeEventListener(n,t,i)}function L(e,n,t){t==null?e.removeAttribute(n):e.getAttribute(n)!==t&&e.setAttribute(n,t)}function Xe(e){return e===""?null:+e}function gt(e){return Array.from(e.childNodes)}function ve(e,n){n=""+n,e.data!==n&&(e.data=n)}function ue(e,n){e.value=n??""}function k(e,n,t,i){t==null?e.style.removeProperty(n):e.style.setProperty(n,t,i?"important":"")}function Ue(e,n,t){e.classList.toggle(n,!!t)}class pt{constructor(n=!1){ae(this,"is_svg",!1);ae(this,"e");ae(this,"n");ae(this,"t");ae(this,"a");this.is_svg=n,this.e=this.n=null}c(n){this.h(n)}m(n,t,i=null){this.e||(this.is_svg?this.e=at(t.nodeName):this.e=w(t.nodeType===11?"TEMPLATE":t.nodeName),this.t=t.tagName!=="TEMPLATE"?t:t.content,this.c(n)),this.i(i)}h(n){this.e.innerHTML=n,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(n){for(let t=0;t<this.n.length;t+=1)ne(this.t,this.n[t],n)}p(n){this.d(),this.h(n),this.i(this.a)}d(){this.n.forEach(ee)}}let Be;function Te(e){Be=e}const we=[],U=[];let ke=[];const De=[],mt=Promise.resolve();let Fe=!1;function _t(){Fe||(Fe=!0,mt.then(lt))}function qe(e){ke.push(e)}function re(e){De.push(e)}const Oe=new Set;let be=0;function lt(){if(be!==0)return;const e=Be;do{try{for(;be<we.length;){const n=we[be];be++,Te(n),bt(n.$$)}}catch(n){throw we.length=0,be=0,n}for(Te(null),we.length=0,be=0;U.length;)U.pop()();for(let n=0;n<ke.length;n+=1){const t=ke[n];Oe.has(t)||(Oe.add(t),t())}ke.length=0}while(we.length);for(;De.length;)De.pop()();Fe=!1,Oe.clear(),Te(e)}function bt(e){if(e.fragment!==null){e.update(),oe(e.before_update);const n=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,n),e.after_update.forEach(qe)}}function wt(e){const n=[],t=[];ke.forEach(i=>e.indexOf(i)===-1?n.push(i):t.push(i)),t.forEach(i=>i()),ke=n}const Ye=new Set;let me;function Ve(){me={r:0,c:[],p:me}}function Ke(){me.r||oe(me.c),me=me.p}function $(e,n){e&&e.i&&(Ye.delete(e),e.i(n))}function ie(e,n,t,i){if(e&&e.o){if(Ye.has(e))return;Ye.add(e),me.c.push(()=>{Ye.delete(e),i&&(t&&e.d(1),i())}),e.o(n)}else i&&i()}function Ze(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function se(e,n,t){const i=e.$$.props[n];i!==void 0&&(e.$$.bound[i]=t,t(e.$$.ctx[i]))}function _e(e){e&&e.c()}function ge(e,n,t){const{fragment:i,after_update:l}=e.$$;i&&i.m(n,t),qe(()=>{const o=e.$$.on_mount.map(nt).filter(it);e.$$.on_destroy?e.$$.on_destroy.push(...o):oe(o),e.$$.on_mount=[]}),l.forEach(qe)}function pe(e,n){const t=e.$$;t.fragment!==null&&(wt(t.after_update),oe(t.on_destroy),t.fragment&&t.fragment.d(n),t.on_destroy=t.fragment=null,t.ctx=[])}function vt(e,n){e.$$.dirty[0]===-1&&(we.push(e),_t(),e.$$.dirty.fill(0)),e.$$.dirty[n/31|0]|=1<<n%31}function He(e,n,t,i,l,o,s,a=[-1]){const c=Be;Te(e);const d=e.$$={fragment:null,ctx:[],props:o,update:he,not_equal:l,bound:ze(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(c?c.$$.context:[])),callbacks:ze(),dirty:a,skip_bound:!1,root:n.target||c.$$.root};s&&s(d.root);let g=!1;if(d.ctx=t?t(e,n.props||{},(p,b,...T)=>{const h=T.length?T[0]:b;return d.ctx&&l(d.ctx[p],d.ctx[p]=h)&&(!d.skip_bound&&d.bound[p]&&d.bound[p](h),g&&vt(e,p)),b}):[],d.update(),g=!0,oe(d.before_update),d.fragment=i?i(d.ctx):!1,n.target){if(n.hydrate){const p=gt(n.target);d.fragment&&d.fragment.l(p),p.forEach(ee)}else d.fragment&&d.fragment.c();n.intro&&$(e.$$.fragment),ge(e,n.target,n.anchor),lt()}Te(c)}class We{constructor(){ae(this,"$$");ae(this,"$$set")}$destroy(){pe(this,1),this.$destroy=he}$on(n,t){if(!it(t))return he;const i=this.$$.callbacks[n]||(this.$$.callbacks[n]=[]);return i.push(t),()=>{const l=i.indexOf(t);l!==-1&&i.splice(l,1)}}$set(n){this.$$set&&!ct(n)&&(this.$$.skip_bound=!0,this.$$set(n),this.$$.skip_bound=!1)}}const kt="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(kt);const Tt=`<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M6 20L18 20" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M12 4V16M12 16L15.5 12.5M12 16L8.5 12.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
`,yt=`<svg width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M14.3632 5.65156L15.8431 4.17157C16.6242 3.39052 17.8905 3.39052 18.6716 4.17157L20.0858 5.58579C20.8668 6.36683 20.8668 7.63316 20.0858 8.41421L18.6058 9.8942M14.3632 5.65156L4.74749 15.2672C4.41542 15.5993 4.21079 16.0376 4.16947 16.5054L3.92738 19.2459C3.87261 19.8659 4.39148 20.3848 5.0115 20.33L7.75191 20.0879C8.21972 20.0466 8.65806 19.8419 8.99013 19.5099L18.6058 9.8942M14.3632 5.65156L18.6058 9.8942" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
`,Ct=`<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M12 14C13.1046 14 14 13.1046 14 12C14 10.8954 13.1046 10 12 10C10.8954 10 10 10.8954 10 12C10 13.1046 10.8954 14 12 14Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M21 12C19.1114 14.991 15.7183 18 12 18C8.2817 18 4.88856 14.991 3 12C5.29855 9.15825 7.99163 6 12 6C16.0084 6 18.7015 9.1582 21 12Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
`,Mt=`<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M3 3L21 21" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M10.5 10.6771C10.1888 11.0296 10 11.4928 10 12C10 13.1045 10.8954 14 12 14C12.5072 14 12.9703 13.8112 13.3229 13.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M7.36185 7.5611C5.68002 8.73968 4.27894 10.4188 3 12C4.88856 14.991 8.2817 18 12 18C13.5499 18 15.0434 17.4772 16.3949 16.6508" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M12 6C16.0084 6 18.7015 9.1582 21 12C20.6815 12.5043 20.3203 13.0092 19.922 13.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
`,Lt=`<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M6 12H18" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
`,Yt=`<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M6 12H12M18 12H12M12 12V6M12 12V18" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
`,Xt=`<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M6 20L18 20" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M12 16V4M12 4L15.5 7.5M12 4L8.5 7.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
`;function Et(e){let n,t=e[1][e[0]]+"",i;return{c(){n=new pt(!1),i=ht(),n.a=i},m(l,o){n.m(t,l,o),ne(l,i,o)},p(l,[o]){o&1&&t!==(t=l[1][l[0]]+"")&&n.p(t)},i:he,o:he,d(l){l&&(ee(i),n.d())}}}function Ht(e,n,t){const i={download:Tt,editPencil:yt,eyeEmpty:Ct,eyeOff:Mt,minus:Lt,plus:Yt,upload:Xt};let{name:l}=n;return e.$$set=o=>{"name"in o&&t(0,l=o.name)},[l,i]}class ye extends We{constructor(n){super(),He(this,n,Ht,Et,Ee,{name:0})}}async function Re(e){return new Promise((n,t)=>{const i=new FileReader;i.addEventListener("load",function(){i.result?n(i.result):t(`error loading ${e}`)}),i.readAsBinaryString(e)})}function Je(e,n,t){const i=e.slice();return i[43]=n[t],i[45]=t,i}function Wt(e){let n,t=e[43].name+"",i,l,o,s,a,c,d,g;const p=[It,St],b=[];function T(h,y){return h[43].visible?0:1}return s=T(e),a=b[s]=p[s](e),{c(){n=w("button"),i=x(t),l=O(),o=w("button"),a.c(),Ue(n,"selected",e[3]===e[45])},m(h,y){ne(h,n,y),f(n,i),ne(h,l,y),ne(h,o,y),b[s].m(o,null),c=!0,d||(g=[W(n,"click",e[16](e[45])),W(o,"click",e[17](e[45]))],d=!0)},p(h,y){e=h,(!c||y[0]&2)&&t!==(t=e[43].name+"")&&ve(i,t),(!c||y[0]&8)&&Ue(n,"selected",e[3]===e[45]);let A=s;s=T(e),s!==A&&(Ve(),ie(b[A],1,1,()=>{b[A]=null}),Ke(),a=b[s],a||(a=b[s]=p[s](e),a.c()),$(a,1),a.m(o,null))},i(h){c||($(a),c=!0)},o(h){ie(a),c=!1},d(h){h&&(ee(n),ee(l),ee(o)),b[s].d(),d=!1,oe(g)}}}function At(e){let n,t,i,l,o,s,a,c,d;return s=new ye({props:{name:"minus"}}),{c(){n=w("input"),l=O(),o=w("button"),_e(s.$$.fragment),L(n,"placeholder",t=e[43].name),n.value=i=e[43].name},m(g,p){ne(g,n,p),ne(g,l,p),ne(g,o,p),ge(s,o,null),a=!0,c||(d=[W(n,"change",e[14](e[45])),W(o,"click",e[15](e[45]))],c=!0)},p(g,p){e=g,(!a||p[0]&2&&t!==(t=e[43].name))&&L(n,"placeholder",t),(!a||p[0]&2&&i!==(i=e[43].name)&&n.value!==i)&&(n.value=i)},i(g){a||($(s.$$.fragment,g),a=!0)},o(g){ie(s.$$.fragment,g),a=!1},d(g){g&&(ee(n),ee(l),ee(o)),pe(s),c=!1,oe(d)}}}function St(e){let n,t;return n=new ye({props:{name:"eyeOff"}}),{c(){_e(n.$$.fragment)},m(i,l){ge(n,i,l),t=!0},i(i){t||($(n.$$.fragment,i),t=!0)},o(i){ie(n.$$.fragment,i),t=!1},d(i){pe(n,i)}}}function It(e){let n,t;return n=new ye({props:{name:"eyeEmpty"}}),{c(){_e(n.$$.fragment)},m(i,l){ge(n,i,l),t=!0},i(i){t||($(n.$$.fragment,i),t=!0)},o(i){ie(n.$$.fragment,i),t=!1},d(i){pe(n,i)}}}function Qe(e){let n,t,i,l;const o=[At,Wt],s=[];function a(c,d){return c[2]?0:1}return t=a(e),i=s[t]=o[t](e),{c(){n=w("div"),i.c()},m(c,d){ne(c,n,d),s[t].m(n,null),l=!0},p(c,d){let g=t;t=a(c),t===g?s[t].p(c,d):(Ve(),ie(s[g],1,1,()=>{s[g]=null}),Ke(),i=s[t],i?i.p(c,d):(i=s[t]=o[t](c),i.c()),$(i,1),i.m(n,null))},i(c){l||($(i),l=!0)},o(c){ie(i),l=!1},d(c){c&&ee(n),s[t].d()}}}function Nt(e){let n,t,i,l,o,s,a,c,d,g,p,b,T,h,y,A,H,m,J,E,v,z,N,B,R,Q,K,_,S,D,Z,fe;R=new ye({props:{name:"editPencil"}});let V=Ze(e[1]),I=[];for(let Y=0;Y<V.length;Y+=1)I[Y]=Qe(Je(e,V,Y));const ce=Y=>ie(I[Y],1,1,()=>{I[Y]=null});return S=new ye({props:{name:"plus"}}),{c(){n=w("div"),t=w("div"),i=w("label"),l=w("input"),o=x(`
      Grid`),s=O(),a=w("label"),c=w("input"),d=x(`
      Hex`),g=O(),p=w("span"),b=x(e[4]),T=x(", "),h=x(e[5]),y=O(),A=w("button"),A.textContent="Save",H=O(),m=w("input"),J=O(),E=w("div"),v=w("canvas"),z=O(),N=w("div"),B=w("button"),_e(R.$$.fragment),Q=O();for(let Y=0;Y<I.length;Y+=1)I[Y].c();K=O(),_=w("button"),_e(S.$$.fragment),L(l,"type","checkbox"),L(c,"type","checkbox"),L(m,"type","file"),L(m,"accept","application/json"),k(t,"display","flex"),k(t,"gap","8px"),L(v,"class","canvas svelte-86wn1t"),L(v,"tabindex","1"),k(N,"display","flex"),k(N,"flex-direction","column"),k(N,"gap","4px"),k(E,"display","flex"),k(E,"flex-grow","1"),k(n,"display","flex"),k(n,"flex-direction","column"),k(n,"flex-grow","1")},m(Y,X){ne(Y,n,X),f(n,t),f(t,i),f(i,l),l.checked=e[6],f(i,o),f(t,s),f(t,a),f(a,c),c.checked=e[7],f(a,d),f(t,g),f(t,p),f(p,b),f(p,T),f(p,h),f(t,y),f(t,A),f(t,H),f(t,m),f(n,J),f(n,E),f(E,v),e[28](v),f(E,z),f(E,N),f(N,B),ge(R,B,null),f(N,Q);for(let M=0;M<I.length;M+=1)I[M]&&I[M].m(N,null);f(N,K),f(N,_),ge(S,_,null),D=!0,Z||(fe=[W(l,"change",e[26]),W(c,"change",e[27]),W(A,"click",Dt),W(m,"change",e[13]),W(v,"wheel",e[11]),W(v,"mousemove",e[10]),W(v,"click",e[9]),W(v,"keydown",e[12]),W(v,"mouseenter",e[29]),W(v,"mouseleave",e[30]),W(B,"click",e[31]),W(_,"click",e[18])],Z=!0)},p(Y,X){if(X[0]&64&&(l.checked=Y[6]),X[0]&128&&(c.checked=Y[7]),(!D||X[0]&16)&&ve(b,Y[4]),(!D||X[0]&32)&&ve(h,Y[5]),X[0]&245774){V=Ze(Y[1]);let M;for(M=0;M<V.length;M+=1){const P=Je(Y,V,M);I[M]?(I[M].p(P,X),$(I[M],1)):(I[M]=Qe(P),I[M].c(),$(I[M],1),I[M].m(N,K))}for(Ve(),M=V.length;M<I.length;M+=1)ce(M);Ke()}},i(Y){if(!D){$(R.$$.fragment,Y);for(let X=0;X<V.length;X+=1)$(I[X]);$(S.$$.fragment,Y),D=!0}},o(Y){ie(R.$$.fragment,Y),I=I.filter(Boolean);for(let X=0;X<I.length;X+=1)ie(I[X]);ie(S.$$.fragment,Y),D=!1},d(Y){Y&&ee(n),e[28](null),pe(R),dt(I,Y),pe(S),Z=!1,oe(fe)}}}function Pt(e,n){const t=Math.round(e),i=Math.round(n);e-=t,n-=i;const l=Math.round(e+.5*n)*(e*e>=n*n?1:0),o=Math.round(n+.5*e)*(e*e<n*n?1:0);return[t+l,i+o]}function jt(e,n,t,i){const l=2*Math.PI/6;e.beginPath();for(var o=0;o<6;o++)e.lineTo(n+i*Math.cos(l*o),t+i*Math.sin(l*o));e.closePath(),e.stroke()}function Ot(e,n,t,i,l){e.beginPath(),e.lineTo(n,t),e.lineTo(n+i,t),e.lineTo(n+i,t+l),e.lineTo(n,t+l),e.closePath(),e.stroke()}function Dt(){}function Ft(e,n,t){let i,l,o,s,a,{selectedTileset:c}=n,{tileWidth:d,tileHeight:g}=n,{selectedTileX:p,selectedTileY:b}=n,T,h=[{name:"Layer 1",visible:!0,tiles:{}}],y=!1,A=0,H,m,J=!0,E=!0,v=1,z=!1;const N=Math.sqrt(3);function B(u,j){return[(u-s)/v,(j-a)/v]}function R(u,j){const[G,r]=B(u,j);return E?Pt(2/3*G/i,(-1/3*G+N/3*r)/i):[Math.floor(G/d),Math.floor(r/g)]}function Q(u,j){return[i*(3/2)*u,i*(N/2*u+N*j)]}function K(u,j,G,r,C,F){const[te,q]=Q(j,G);u.drawImage(r,C*d,F*g,d,g,te-i,q-o-6,d*1.01,g*1.01)}function _(u,j,G,r,C,F){u.drawImage(r,C*d,F*g,d,g,j*d,G*g,d,g)}function S(){const u=T.getContext("2d");if(!u)return;const j=T.scrollWidth,G=T.scrollHeight;if(t(0,T.width=j-4,T),t(0,T.height=G-4,T),u.imageSmoothingEnabled=!1,u.resetTransform(),u.clearRect(0,0,j,G),u.setTransform(v,0,0,v,s,a),u.strokeStyle="white",J)if(E)for(let r=0;r<j/l-1;r++)for(let C=0;C<G/o-1;C++){const[F,te]=Q(r,C-Math.floor(r/2));jt(u,F,te,i)}else for(let r=0;r<j/d-1;r++)for(let C=0;C<G/g-1;C++)Ot(u,r*d,C*g,d,g);h.forEach(r=>{r.visible&&Object.entries(r.tiles).sort((C,F)=>{const[te,q]=C[0].split(",").map(je=>parseInt(je)),[de,Ce]=F[0].split(",").map(je=>parseInt(je));return q===Ce?te-de:q-Ce}).forEach(C=>{const[F,te]=C[0].split(",").map(de=>parseInt(de)),q=C[1];q.img&&q.img.complete&&(E?K(u,F,te,q.img,q.tileX,q.tileY):_(u,F,te,q.img,q.tileX,q.tileY))})}),c&&c.complete&&H!==void 0&&m!==void 0&&(E?K(u,H,m,c,p,b):_(u,H,m,c,p,b))}function D(u){const[j,G]=R(u.offsetX,u.offsetY);t(1,h[A].tiles[`${j},${G}`]={img:c,tileX:p,tileY:b},h),S()}function Z(u){t(4,[H,m]=R(u.offsetX,u.offsetY),H,t(5,m)),u.buttons===1?D(u):u.ctrlKey&&(s+=u.movementX,a+=u.movementY),requestAnimationFrame(S)}function fe(u){const j=v;u.deltaY<0?v*=1.1:u.deltaY>0&&(v*=.9),v=Math.min(Math.max(.25,v),8),s=-v*(u.offsetX-s)/j+u.offsetX,a=-v*(u.offsetY-a)/j+u.offsetY,requestAnimationFrame(S)}function V(u){if(console.log("map"),!!z){switch(u.key){case"ArrowLeft":s+=v*i,u.preventDefault();break;case"ArrowRight":s-=v*i,u.preventDefault();break;case"ArrowUp":a+=v*o,u.preventDefault();break;case"ArrowDown":a-=v*o,u.preventDefault();break}requestAnimationFrame(S)}}function I(u){if(u.target===null)return;const j=u.target.files;if(j===null)return;const G=j[0];Re(G).then(r=>{console.log(JSON.parse(r))})}function ce(u){return j=>{j.currentTarget!==null&&t(1,h[u].name=j.currentTarget.value,h)}}function Y(u){return()=>{h.splice(u,1),t(1,h)}}function X(u){return()=>{t(3,A=u)}}function M(u){return()=>{t(1,h[u].visible=!h[u].visible,h),t(1,h)}}function P(){h.push({name:`Layer ${h.length+1}`,visible:!0,tiles:{}}),t(1,h)}function le(){J=this.checked,t(6,J)}function Ae(){E=this.checked,t(7,E)}function Se(u){U[u?"unshift":"push"](()=>{T=u,t(0,T)})}const Ie=()=>{T.focus(),t(8,z=!0)},Ne=()=>{t(8,z=!1)},Pe=()=>{t(2,y=!y)};return e.$$set=u=>{"selectedTileset"in u&&t(19,c=u.selectedTileset),"tileWidth"in u&&t(20,d=u.tileWidth),"tileHeight"in u&&t(21,g=u.tileHeight),"selectedTileX"in u&&t(22,p=u.selectedTileX),"selectedTileY"in u&&t(23,b=u.selectedTileY)},e.$$.update=()=>{e.$$.dirty[0]&1048576&&t(25,i=d/2),e.$$.dirty[0]&33554432&&(l=3/2*i),e.$$.dirty[0]&33554432&&t(24,o=Math.ceil(N*i)),e.$$.dirty[0]&33554432&&(s=i),e.$$.dirty[0]&16777216&&(a=o/2)},[T,h,y,A,H,m,J,E,z,D,Z,fe,V,I,ce,Y,X,M,P,c,d,g,p,b,o,i,le,Ae,Se,Ie,Ne,Pe]}class qt extends We{constructor(n){super(),He(this,n,Ft,Nt,Ee,{selectedTileset:19,tileWidth:20,tileHeight:21,selectedTileX:22,selectedTileY:23},null,[-1,-1])}}const Rt=String.fromCharCode(137,80,78,71,13,10,26,10),ot="tEXt";function Bt(e){for(let n of st(e))if(rt(n))return JSON.parse(n.data)}function Vt(e,n){const t=st(e),i=t.findIndex(rt),l={type:ot,data:JSON.stringify(n)};return i===-1?t.splice(1,0,l):t[i]=l,Kt(t)}function rt(e){return e.type===ot&&e.data.startsWith("{")&&e.data.endsWith("}")}function st(e){e=e.substring(8);const n=[];for(;e!=="";){let t=zt(e.substring(0,4));t<0&&(t=0);const i=e.substring(0,t+12);e=e.substring(t+12);const l=i.substring(4,8);let o="";t>0&&(o=i.substring(8,t+8)),n.push({type:l,data:o})}return n}function Kt(e){let n=Rt;for(let t of e){let i=xe(t.data.length,4);i+=t.type,i+=t.data,i+=xe(Gt(t.type+t.data),4),n+=i}return n}function xe(e,n){for(var t=[],i=n-1;i>=0;){var l=e&255;t[i--]=l,e=e>>8}return t=t.map(function(o){return String.fromCharCode(o)}),t.join("")}function zt(e){for(var n=0,t=0;t<e.length;t++){var i=e.charCodeAt(t);n=n<<8|i&255}return n}function Gt(e){for(var n=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],t=-1,i=0;i<e.length;i++)t=t>>>8^n[(t^e.charCodeAt(i))&255];return(t^-1)>>>0}function $e(e){let n,t,i,l,o,s;return{c(){n=w("label"),t=w("button"),t.textContent="Merge Tileset",i=O(),l=w("input"),k(l,"display","none"),L(l,"name","merge"),L(l,"type","file"),L(l,"accept","image/png"),L(n,"for","merge")},m(a,c){ne(a,n,c),f(n,t),f(n,i),f(n,l),e[31](l),o||(s=[W(t,"click",e[30]),W(l,"change",e[18])],o=!0)},p:he,d(a){a&&ee(n),e[31](null),o=!1,oe(s)}}}function et(e){let n,t,i,l,o,s,a,c,d,g,p,b,T,h,y,A;return{c(){n=w("div"),t=w("div"),i=x("Selected: Tile "),l=x(e[11]),o=x(" ("),s=x(e[3]),a=x(", "),c=x(e[4]),d=x(")"),g=O(),p=w("div"),b=w("label"),b.textContent="Tags",T=O(),h=w("input"),L(b,"for","tags"),L(h,"name","tags"),L(h,"type","text"),k(p,"display","flex"),k(p,"flex-direction","column"),k(p,"align-items","start"),k(n,"display","flex"),k(n,"flex-direction","column"),k(n,"gap","8px"),k(n,"align-items","start")},m(H,m){ne(H,n,m),f(n,t),f(t,i),f(t,l),f(t,o),f(t,s),f(t,a),f(t,c),f(t,d),f(n,g),f(n,p),f(p,b),f(p,T),f(p,h),ue(h,e[13]),e[39](h),y||(A=[W(h,"change",e[19]),W(h,"input",e[38])],y=!0)},p(H,m){m[0]&2048&&ve(l,H[11]),m[0]&8&&ve(s,H[3]),m[0]&16&&ve(c,H[4]),m[0]&8192&&h.value!==H[13]&&ue(h,H[13])},d(H){H&&ee(n),e[39](null),y=!1,oe(A)}}}function Ut(e){let n,t,i,l,o,s,a,c,d,g,p,b,T,h,y,A,H,m,J,E,v,z,N,B,R,Q,K,_,S,D,Z,fe,V,I,ce,Y,X=e[0]&&e[0].src&&$e(e),M=e[3]!==void 0&&e[4]!==void 0&&et(e);return{c(){n=w("div"),t=w("div"),i=w("input"),l=O(),o=w("div"),s=w("label"),s.textContent="Name",a=O(),c=w("input"),d=O(),g=w("div"),p=w("label"),p.textContent="Width",b=O(),T=w("input"),h=O(),y=w("div"),A=w("label"),A.textContent="Height",H=O(),m=w("input"),J=O(),E=w("div"),X&&X.c(),v=O(),z=w("button"),z.textContent="Save",N=O(),B=w("div"),R=w("input"),Q=O(),K=w("img"),S=O(),D=w("img"),fe=O(),V=w("canvas"),I=O(),M&&M.c(),L(i,"type","file"),L(i,"accept","image/png"),L(s,"for","name"),L(c,"name","name"),L(c,"type","text"),k(o,"display","flex"),k(o,"flex-direction","column"),k(o,"align-items","start"),L(p,"for","width"),L(T,"name","width"),L(T,"type","number"),L(T,"min","1"),L(T,"max","64"),k(T,"max-width","4em"),k(g,"display","flex"),k(g,"flex-direction","column"),k(g,"align-items","start"),L(A,"for","height"),L(m,"name","height"),L(m,"type","number"),L(m,"min","1"),L(m,"max","64"),k(m,"max-width","4em"),k(y,"display","flex"),k(y,"flex-direction","column"),k(y,"align-items","start"),k(E,"margin-left","auto"),k(E,"display","flex"),k(E,"gap","8px"),k(t,"display","flex"),k(t,"gap","8px"),k(t,"align-items","end"),L(R,"name","filter"),L(R,"type","text"),L(R,"placeholder","Filter"),k(B,"display","flex"),k(B,"gap","8px"),k(B,"align-items","end"),Ge(K.src,_="")||L(K,"src",_),k(K,"display","none"),Ge(D.src,Z="")||L(D,"src",Z),k(D,"display","none"),L(V,"class","canvas svelte-5reh94"),L(V,"tabindex","1"),k(n,"display","flex"),k(n,"flex-direction","column"),k(n,"gap","8px")},m(P,le){ne(P,n,le),f(n,t),f(t,i),f(t,l),f(t,o),f(o,s),f(o,a),f(o,c),ue(c,e[12]),f(t,d),f(t,g),f(g,p),f(g,b),f(g,T),ue(T,e[1]),f(t,h),f(t,y),f(y,A),f(y,H),f(y,m),ue(m,e[2]),f(t,J),f(t,E),X&&X.m(E,null),f(E,v),f(E,z),f(n,N),f(n,B),f(B,R),ue(R,e[6]),f(n,Q),f(n,K),e[33](K),f(n,S),f(n,D),e[34](D),f(n,fe),f(n,V),e[35](V),f(n,I),M&&M.m(n,null),ce||(Y=[W(i,"change",e[17]),W(c,"input",e[27]),W(T,"input",e[28]),W(m,"input",e[29]),W(z,"click",e[20]),W(R,"input",e[32]),W(V,"wheel",e[14]),W(V,"click",e[15]),W(V,"mousemove",e[16]),W(V,"keydown",e[21]),W(V,"mouseenter",e[36]),W(V,"mouseleave",e[37])],ce=!0)},p(P,le){le[0]&4096&&c.value!==P[12]&&ue(c,P[12]),le[0]&2&&Xe(T.value)!==P[1]&&ue(T,P[1]),le[0]&4&&Xe(m.value)!==P[2]&&ue(m,P[2]),P[0]&&P[0].src?X?X.p(P,le):(X=$e(P),X.c(),X.m(E,v)):X&&(X.d(1),X=null),le[0]&64&&R.value!==P[6]&&ue(R,P[6]),P[3]!==void 0&&P[4]!==void 0?M?M.p(P,le):(M=et(P),M.c(),M.m(n,null)):M&&(M.d(1),M=null)},i:he,o:he,d(P){P&&ee(n),X&&X.d(),e[33](null),e[34](null),e[35](null),M&&M.d(),ce=!1,oe(Y)}}}const Le="data:image/png;base64,";function tt(e,n,t,i,l){e.beginPath(),e.lineTo(n,t),e.lineTo(n+i,t),e.lineTo(n+i,t+l),e.lineTo(n,t+l),e.closePath(),e.stroke()}function Zt(e,n){const t=document.createElement("canvas");t.width=e.width+n.width,t.height=Math.max(e.height,n.height);const i=t.getContext("2d");if(i)return i.imageSmoothingEnabled=!1,i.resetTransform(),i.drawImage(e,0,0,e.width,e.height),i.drawImage(n,e.width,0,n.width,n.height),t.toDataURL("image/png")}function Jt(e,n,t){let{tileset:i}=n,{tileWidth:l,tileHeight:o}=n,{selectedTileX:s,selectedTileY:a}=n,c,d,g,p,b=2,T=!1,h=0,y=0,A,H,m,J,E,v,z,N={},B;function R(r,C){return[(r-h)/b,(C-y)/b]}function Q(){var te;if(!p)return;const r=p.getContext("2d");if(!r)return;const C=p.scrollWidth,F=p.scrollHeight;if(t(9,p.width=C-4,p),t(9,p.height=F-4,p),r.imageSmoothingEnabled=!1,r.resetTransform(),r.clearRect(0,0,C,F),r.setTransform(b,0,0,b,h,y),i&&i.complete)if(l!==void 0&&o!==void 0&&m!==void 0&&J!==void 0)for(let q=0;q<m;q++)for(let de=0;de<J;de++){const Ce=de*m+q;(B===void 0||B===""||(te=N[Ce])!=null&&te.includes(B))&&r.drawImage(i,q*l,de*o,l,o,q*l,de*o,l,o)}else r.drawImage(i,0,0,i.width,i.height);r.strokeStyle="white",r.lineWidth=1,l!==void 0&&o!==void 0&&(A!=null&&H!==void 0&&tt(r,A*l,H*o,l,o),s!==void 0&&a!==void 0&&tt(r,s*l,a*o,l,o))}function K(r){const C=b;r.deltaY<0?t(22,b*=1.1):r.deltaY>0&&t(22,b*=.9),t(22,b=Math.min(Math.max(.25,b),8)),t(23,h=-b*(r.offsetX-h)/C+r.offsetX),t(24,y=-b*(r.offsetY-y)/C+r.offsetY)}function _(r){const[C,F]=R(r.offsetX,r.offsetY);C<0||C>=i.width||F<0||F>=i.height||l!==void 0&&o!==void 0&&m!==void 0&&(t(3,s=Math.floor(C/l)),t(4,a=Math.floor(F/o)),t(11,E=a*m+s),t(13,z=N[E]||""))}function S(r){if(r.buttons===1?_(r):r.ctrlKey&&(t(23,h+=r.movementX),t(24,y+=r.movementY)),l!==void 0&&o!==void 0){const[C,F]=R(r.offsetX,r.offsetY);t(25,A=Math.floor(C/l)),t(26,H=Math.floor(F/o))}}function D(r){if(r.target===null)return;const C=r.target.files;if(C===null)return;const F=C[0];F&&Re(F).then(te=>{i.setAttribute("src",Le+btoa(te)),t(0,i.onload=()=>{requestAnimationFrame(Q)},i),t(12,v=""),t(1,l=void 0),t(2,o=void 0),t(13,z=""),N={},t(3,s=0),t(4,a=0),t(11,E=0),t(23,h=0),t(24,y=0),t(22,b=2);const q=Bt(te);q&&(t(12,v=q.name||""),t(1,l=q.tileWidth),t(2,o=q.tileHeight),N=q.tags||{})})}function Z(){if(!g||!g.files)return;const r=g.files[0];r&&Re(r).then(C=>{t(5,c.onload=()=>{const F=Zt(i,c);F&&(i.setAttribute("src",F),t(0,i.onload=()=>{requestAnimationFrame(Q)},i)),c.setAttribute("src","")},c),c.setAttribute("src",Le+btoa(C))})}function fe(){E!==void 0&&(N[E]=z)}function V(){const r=Vt(atob(i.src.substring(Le.length)),{name:v,tileWidth:l,tileHeight:o,tags:N});i.setAttribute("src",Le+btoa(r));const C=document.createElement("a");C.href=i.src,v?C.download=`${v}.png`:C.download="tileset.png",C.click()}function I(...r){i&&l!==void 0&&o!==void 0&&(m=i.width/l,J=i.height/o),requestAnimationFrame(Q)}function ce(r){if(console.log("tileset"),!!T&&!(l===void 0||o===void 0)){switch(r.key){case"ArrowLeft":t(23,h+=b*l),r.preventDefault();break;case"ArrowRight":t(23,h-=b*l),r.preventDefault();break;case"ArrowUp":t(24,y+=b*o),r.preventDefault();break;case"ArrowDown":t(24,y-=b*o),r.preventDefault();break}requestAnimationFrame(Q)}}function Y(){v=this.value,t(12,v)}function X(){l=Xe(this.value),t(1,l)}function M(){o=Xe(this.value),t(2,o)}const P=()=>{g.click()};function le(r){U[r?"unshift":"push"](()=>{g=r,t(8,g)})}function Ae(){B=this.value,t(6,B)}function Se(r){U[r?"unshift":"push"](()=>{i=r,t(0,i)})}function Ie(r){U[r?"unshift":"push"](()=>{c=r,t(5,c)})}function Ne(r){U[r?"unshift":"push"](()=>{p=r,t(9,p)})}const Pe=()=>{p.focus(),t(10,T=!0)},u=()=>{t(10,T=!1)};function j(){z=this.value,t(13,z)}function G(r){U[r?"unshift":"push"](()=>{d=r,t(7,d)})}return e.$$set=r=>{"tileset"in r&&t(0,i=r.tileset),"tileWidth"in r&&t(1,l=r.tileWidth),"tileHeight"in r&&t(2,o=r.tileHeight),"selectedTileX"in r&&t(3,s=r.selectedTileX),"selectedTileY"in r&&t(4,a=r.selectedTileY)},e.$$.update=()=>{e.$$.dirty[0]&130023551&&I(i,c,l,o,b,h,y,B,A,H,s,a)},[i,l,o,s,a,c,B,d,g,p,T,E,v,z,K,_,S,D,Z,fe,V,ce,b,h,y,A,H,Y,X,M,P,le,Ae,Se,Ie,Ne,Pe,u,j,G]}class Qt extends We{constructor(n){super(),He(this,n,Jt,Ut,Ee,{tileset:0,tileWidth:1,tileHeight:2,selectedTileX:3,selectedTileY:4},null,[-1,-1])}}function xt(e){let n,t,i,l,o,s,a,c,d,g,p,b,T,h,y;function A(_){e[5](_)}function H(_){e[6](_)}function m(_){e[7](_)}function J(_){e[8](_)}function E(_){e[9](_)}let v={};e[0]!==void 0&&(v.tileset=e[0]),e[1]!==void 0&&(v.tileWidth=e[1]),e[2]!==void 0&&(v.tileHeight=e[2]),e[3]!==void 0&&(v.selectedTileX=e[3]),e[4]!==void 0&&(v.selectedTileY=e[4]),t=new Qt({props:v}),U.push(()=>se(t,"tileset",A)),U.push(()=>se(t,"tileWidth",H)),U.push(()=>se(t,"tileHeight",m)),U.push(()=>se(t,"selectedTileX",J)),U.push(()=>se(t,"selectedTileY",E));function z(_){e[10](_)}function N(_){e[11](_)}function B(_){e[12](_)}function R(_){e[13](_)}function Q(_){e[14](_)}let K={};return e[0]!==void 0&&(K.selectedTileset=e[0]),e[1]!==void 0&&(K.tileWidth=e[1]),e[2]!==void 0&&(K.tileHeight=e[2]),e[3]!==void 0&&(K.selectedTileX=e[3]),e[4]!==void 0&&(K.selectedTileY=e[4]),d=new qt({props:K}),U.push(()=>se(d,"selectedTileset",z)),U.push(()=>se(d,"tileWidth",N)),U.push(()=>se(d,"tileHeight",B)),U.push(()=>se(d,"selectedTileX",R)),U.push(()=>se(d,"selectedTileY",Q)),{c(){n=w("div"),_e(t.$$.fragment),c=O(),_e(d.$$.fragment),k(n,"display","flex"),k(n,"gap","16px"),k(n,"justify-content","space-between"),k(n,"width","100%")},m(_,S){ne(_,n,S),ge(t,n,null),f(n,c),ge(d,n,null),y=!0},p(_,[S]){const D={};!i&&S&1&&(i=!0,D.tileset=_[0],re(()=>i=!1)),!l&&S&2&&(l=!0,D.tileWidth=_[1],re(()=>l=!1)),!o&&S&4&&(o=!0,D.tileHeight=_[2],re(()=>o=!1)),!s&&S&8&&(s=!0,D.selectedTileX=_[3],re(()=>s=!1)),!a&&S&16&&(a=!0,D.selectedTileY=_[4],re(()=>a=!1)),t.$set(D);const Z={};!g&&S&1&&(g=!0,Z.selectedTileset=_[0],re(()=>g=!1)),!p&&S&2&&(p=!0,Z.tileWidth=_[1],re(()=>p=!1)),!b&&S&4&&(b=!0,Z.tileHeight=_[2],re(()=>b=!1)),!T&&S&8&&(T=!0,Z.selectedTileX=_[3],re(()=>T=!1)),!h&&S&16&&(h=!0,Z.selectedTileY=_[4],re(()=>h=!1)),d.$set(Z)},i(_){y||($(t.$$.fragment,_),$(d.$$.fragment,_),y=!0)},o(_){ie(t.$$.fragment,_),ie(d.$$.fragment,_),y=!1},d(_){_&&ee(n),pe(t),pe(d)}}}function $t(e,n,t){let i,l,o,s,a;function c(m){i=m,t(0,i)}function d(m){l=m,t(1,l)}function g(m){o=m,t(2,o)}function p(m){s=m,t(3,s)}function b(m){a=m,t(4,a)}function T(m){i=m,t(0,i)}function h(m){l=m,t(1,l)}function y(m){o=m,t(2,o)}function A(m){s=m,t(3,s)}function H(m){a=m,t(4,a)}return[i,l,o,s,a,c,d,g,p,b,T,h,y,A,H]}class en extends We{constructor(n){super(),He(this,n,$t,xt,Ee,{})}}new en({target:document.getElementById("app")});
